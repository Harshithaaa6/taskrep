<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Food Order Tracker â€” Prototype</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#ff6b6b; --accent-2:#7c5cff;
    --glass: rgba(255,255,255,0.03); --success:#7fffd4;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#071022 0%,#081226 100%);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#e9f0f7}
  .wrap{max-width:1100px;margin:28px auto;padding:18px;}
  header{display:flex;gap:16px;align-items:center;justify-content:space-between}
  h1{font-size:20px;margin:0}
  .muted{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
  .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 36px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.02)}
  .controls{display:flex;gap:8px;align-items:center}
  input[type=text]{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;min-width:220px}
  button{background:var(--accent);border:none;padding:10px 12px;border-radius:10px;color:white;cursor:pointer;font-weight:600}
  button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);font-weight:600}
  /* Timeline */
  .timeline{display:flex;flex-direction:column;gap:14px}
  .step{display:flex;gap:12px;align-items:flex-start}
  .badge{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;background:var(--glass);border:1px solid rgba(255,255,255,0.02)}
  .step h4{margin:0;font-size:15px}
  .step p{margin:6px 0 0;color:var(--muted);font-size:13px}
  .step.active .badge{background:linear-gradient(135deg,var(--accent-2),var(--accent));box-shadow:0 8px 24px rgba(124,92,255,0.14);color:white}
  .step.done .badge{background:linear-gradient(135deg,#1f6;#2fbf8f);color:#012;box-shadow:0 6px 18px rgba(127,255,205,0.06)}
  /* ETA & driver */
  .eta{font-size:28px;font-weight:700}
  .driver{display:flex;gap:12px;align-items:center;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02)}
  .avatar{width:64px;height:64px;border-radius:12px;flex-shrink:0;object-fit:cover;background:linear-gradient(135deg,var(--accent-2),var(--accent))}
  .meta{font-size:13px}
  .small{font-size:12px;color:var(--muted)}
  /* map */
  .mapWrap{border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.02)}
  svg{display:block;width:100%}
  /* responsive */
  @media (max-width:900px){ .grid{grid-template-columns:1fr; } .controls{flex-direction:column;align-items:stretch} input[type=text]{width:100%;} .card{padding:12px}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Food Order Tracker</h1>
        <div class="muted">Enter your order ID to see real-time progress and driver location.</div>
      </div>
      <div class="small muted">Prototype â€¢ Client-side simulation</div>
    </header>

    <div class="grid">
      <!-- LEFT: Tracking panel -->
      <section class="card" aria-labelledby="tracker-heading">
        <h2 id="tracker-heading" style="margin:0 0 12px 0;font-size:16px">Track your order</h2>

        <div class="controls" role="search" aria-label="Search order">
          <input id="orderId" type="text" placeholder="Enter order ID (e.g. ORD-1024)" aria-label="Order ID" />
          <button id="lookupBtn" aria-label="Lookup order">Lookup</button>
          <button id="simToggle" class="secondary" aria-pressed="false">Simulate live updates</button>
        </div>

        <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">

        <div id="orderCard" aria-live="polite">
          <!-- filled via JS -->
          <div class="muted">No order loaded. Try <strong>ORD-1024</strong> or click simulate.</div>
        </div>

      </section>

      <!-- RIGHT: Map & driver -->
      <aside class="card" aria-labelledby="map-heading">
        <h3 id="map-heading" style="margin:0 0 12px 0;font-size:16px">Live map & driver</h3>

        <div class="mapWrap" style="height:300px;margin-bottom:12px;" aria-hidden="false" role="img" aria-label="Map showing driver position">
          <!-- Simple SVG map: a stylized route from restaurant to customer -->
          <svg viewBox="0 0 800 400" id="svgMap" preserveAspectRatio="xMidYMid meet">
            <defs>
              <linearGradient id="roadGrad" x1="0" x2="1">
                <stop offset="0%" stop-color="#0f2233"/>
                <stop offset="100%" stop-color="#071022"/>
              </linearGradient>
            </defs>

            <rect x="0" y="0" width="800" height="400" fill="url(#roadGrad)" />

            <!-- landmarks -->
            <g id="landmarks" font-family="Inter,Arial" font-size="12" fill="#d8e6f6">
              <circle cx="120" cy="80" r="18" fill="#ffb86b"/>
              <text x="150" y="85">Restaurant</text>

              <circle cx="680" cy="320" r="16" fill="#7fffd4"/>
              <text x="560" y="325">Your location</text>
            </g>

            <!-- route path -->
            <path id="route" d="M130 90 C 220 40, 340 120, 420 90 S 610 180, 700 300" stroke="rgba(255,255,255,0.08)" stroke-width="8" fill="none" stroke-linecap="round"/>

            <!-- animated dotted route overlay -->
            <path id="routeDots" d="M130 90 C 220 40, 340 120, 420 90 S 610 180, 700 300" stroke="rgba(255,255,255,0.06)" stroke-width="18" stroke-dasharray="4 12" fill="none" stroke-linecap="round"/>

            <!-- driver marker (circle + shadow) -->
            <g id="driverMarker" transform="translate(130,90)">
              <ellipse rx="18" ry="6" fill="rgba(0,0,0,0.4)" transform="translate(0,22)"/>
              <rect x="-14" y="-22" width="28" height="28" rx="6" ry="6" fill="#ff6b6b" stroke="#fff" stroke-opacity="0.06"/>
              <text x="0" y="-6" font-size="12" font-weight="700" text-anchor="middle" fill="#fff">ðŸš²</text>
            </g>

            <!-- customer marker -->
            <g id="custMarker" transform="translate(680,320)">
              <circle r="10" fill="#7fffd4" stroke="#043" stroke-opacity="0.06"/>
            </g>
          </svg>
        </div>

        <div style="display:flex;gap:12px;align-items:center;">
          <div class="driver" style="flex:1">
            <img class="avatar" id="driverAvatar" src="" alt="Driver photo" />
            <div style="flex:1">
              <div id="driverName" style="font-weight:700">â€”</div>
              <div class="meta small" id="driverMeta">â€”</div>
              <div class="small muted" id="driverETA">ETA: â€”</div>
            </div>
          </div>
        </div>

      </aside>
    </div>
  </div>

<script>
/* =========================
   Mock dataset + utilities
   ========================= */
const MOCK_ORDERS = {
  "ORD-1024": {
    id: "ORD-1024",
    restaurant: "Kite Street Eats",
    items: ["Paneer Wrap", "Lemonade", "Garlic Fries"],
    total: "â‚¹499",
    statusIndex: 0, // 0..4 steps
    placedAt: Date.now() - 1000*60*7, // 7 minutes ago
    estMinutes: 28, // remaining at start
    driver: { name: "Ravi Kumar", vehicle: "Bicycle â€¢ KA-01-XY-1234", photo: null }
  },
  "ORD-2048": {
    id: "ORD-2048",
    restaurant: "Spice Box",
    items: ["Chicken Biryani", "Raita"],
    total: "â‚¹650",
    statusIndex: 1,
    placedAt: Date.now() - 1000*60*20,
    estMinutes: 12,
    driver: { name: "Sneha P.", vehicle: "Scooter â€¢ KA-05-AB-4321", photo: null }
  }
};

const STEPS = [
  { key: "received", label: "Order Received", description: "We've received your order and kitchen is notified." },
  { key: "preparing", label: "Preparing", description: "Restaurant is preparing your meal." },
  { key: "ready", label: "Ready for pickup", description: "Order is ready and handing to the delivery partner." },
  { key: "out", label: "Out for delivery", description: "Driver is on the way to you." },
  { key: "delivered", label: "Delivered", description: "Enjoy your meal! Order was delivered." }
];

let simulate = false;
let simInterval = null;
let currentOrder = null;

/* =========================
   UI helpers
   ========================= */
const orderCard = document.getElementById('orderCard');
const lookupBtn = document.getElementById('lookupBtn');
const orderIdInput = document.getElementById('orderId');
const simToggle = document.getElementById('simToggle');
const svgMap = document.getElementById('svgMap');
const driverAvatar = document.getElementById('driverAvatar');
const driverName = document.getElementById('driverName');
const driverMeta = document.getElementById('driverMeta');
const driverETA = document.getElementById('driverETA');
const driverMarker = document.getElementById('driverMarker');
const routePath = document.getElementById('route');

/* small placeholder image gradient as avatar */
function avatarDataUrl(name) {
  // simple SVG avatar with initials
  const initials = name.split(' ').map(s=>s[0]||'').slice(0,2).join('').toUpperCase();
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='#7c5cff'/><stop offset='1' stop-color='#ff6b6b'/></linearGradient></defs><rect width='100%' height='100%' fill='url(#g)' rx='24' ry='24' /><text x='50%' y='55%' font-family='Inter,Arial' font-size='72' fill='white' font-weight='700' text-anchor='middle'>${initials}</text></svg>`;
  return 'data:image/svg+xml;base64,' + btoa(svg);
}

/* compute point on path for animation */
function getPathLength(){ return routePath.getTotalLength(); }
function setDriverPosition(progress){ // progress 0..1 along path
  const path = routePath;
  const len = path.getTotalLength();
  const pt = path.getPointAtLength(len * progress);
  driverMarker.setAttribute('transform', `translate(${pt.x},${pt.y})`);
}

/* render order card */
function renderOrder(order){
  currentOrder = order;
  const html = `
    <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
      <div>
        <div style="font-weight:800">${escapeHtml(order.restaurant)}</div>
        <div class="small muted">Order â€¢ <strong>${escapeHtml(order.id)}</strong></div>
        <div class="muted small" style="margin-top:8px">${order.items.join(' â€¢ ')} â€¢ <strong>${order.total}</strong></div>
      </div>
      <div style="text-align:right">
        <div class="muted small">Placed</div>
        <div class="small">${new Date(order.placedAt).toLocaleTimeString()}</div>
      </div>
    </div>

    <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">

    <div class="timeline" id="timeline">
      ${STEPS.map((s,i) => {
        const cls = i < order.statusIndex ? 'step done' : (i === order.statusIndex ? 'step active' : 'step');
        return `<div class="${cls}" data-step="${i}">
          <div class="badge" aria-hidden="true">${i<order.statusIndex? 'âœ“' : (i===order.statusIndex? i+1 : i+1)}</div>
          <div>
            <h4>${escapeHtml(s.label)}</h4>
            <p>${escapeHtml(s.description)}</p>
          </div>
        </div>`;
      }).join('')}
    </div>

    <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">

    <div style="display:flex;gap:12px;align-items:center;">
      <div style="flex:1">
        <div class="small muted">Estimated arrival</div>
        <div class="eta" id="etaText">â€”</div>
        <div class="small muted" id="etaSub">Remaining</div>
      </div>
      <div style="min-width:160px;text-align:right">
        <button id="refreshBtn" class="secondary">Refresh</button>
        <button id="helpBtn" style="margin-left:8px" class="secondary">Contact</button>
      </div>
    </div>
  `;
  orderCard.innerHTML = html;

  // set driver info
  driverAvatar.src = order.driver.photo || avatarDataUrl(order.driver.name);
  driverName.textContent = order.driver.name;
  driverMeta.textContent = order.driver.vehicle;
  updateETADisplay();

  // attach refresh/contact buttons
  document.getElementById('refreshBtn').onclick = ()=> { updateETADisplay(true); };
  document.getElementById('helpBtn').onclick = ()=> { alert('Contacting support is not implemented in this demo.'); };

  // set driver position based on statusIndex
  // map progress: 0 -> near restaurant, 1 -> delivered
  const progressForStatus = (order.statusIndex) => {
    const p = (order.statusIndex) / (STEPS.length - 1); // 0..1
    // add small random offset
    return Math.max(0, Math.min(1, p + 0.02));
  };
  setDriverPosition(progressForStatus(order));
}

/* update ETA countdown */
function updateETADisplay(force=false){
  if(!currentOrder) return;
  const etaText = document.getElementById('etaText');
  const now = Date.now();
  // estimate remaining = estMinutes - elapsed since placed
  const elapsedMin = Math.floor((now - currentOrder.placedAt) / 60000);
  let remaining = Math.max(0, currentOrder.estMinutes - elapsedMin);
  etaText.textContent = remaining > 0 ? `${remaining} min` : 'Arriving';
  driverETA.textContent = remaining > 0 ? `ETA ${remaining} min` : `Arriving now`;
  // small live update every 30s if not forced by refresh
  if(!force){
    // noop
  }
}

/* escape helper */
function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* =========================
   Lookup & simulation
   ========================= */
lookupBtn.onclick = () => {
  const id = (orderIdInput.value || '').trim().toUpperCase();
  if(!id){ alert('Please type an order ID (e.g. ORD-1024).'); return; }
  const order = MOCK_ORDERS[id];
  if(!order){ alert('Order not found in demo dataset. Try ORD-1024 or ORD-2048.'); return; }
  renderOrder(JSON.parse(JSON.stringify(order))); // clone
};

simToggle.onclick = () => {
  simulate = !simulate;
  simToggle.setAttribute('aria-pressed', String(simulate));
  simToggle.textContent = simulate ? 'Stop simulation' : 'Simulate live updates';
  if(simulate) startSimulation(); else stopSimulation();
};

/* start / stop simulation that updates current mock order */
function startSimulation(){
  // choose a sample order if none loaded
  if(!currentOrder){
    renderOrder(JSON.parse(JSON.stringify(MOCK_ORDERS["ORD-1024"])));
  }
  simInterval = setInterval(() => {
    // advance status occasionally
    if(!currentOrder) return;
    // randomly progress
    if(Math.random() > 0.35 && currentOrder.statusIndex < STEPS.length -1){
      currentOrder.statusIndex += 1;
      // decrease estMinutes
      currentOrder.estMinutes = Math.max(0, currentOrder.estMinutes - (3 + Math.floor(Math.random()*5)));
      renderOrder(currentOrder);
    } else {
      // small movement along path without status change
      // nudge estMinutes down slightly
      currentOrder.estMinutes = Math.max(0, currentOrder.estMinutes - 1);
      updateETADisplay();
      // animate driver along path a bit
      animateDriverOnce();
    }
    // if delivered, stop simulation automatically after a moment
    if(currentOrder.statusIndex >= STEPS.length - 1){
      // final animation
      animateDriverOnce(1); // place at end
      setTimeout(()=>{ stopSimulation(); simToggle.textContent = 'Simulate live updates'; simToggle.setAttribute('aria-pressed','false'); }, 4000);
    }
  }, 2500);
}

function stopSimulation(){
  clearInterval(simInterval);
  simInterval = null;
  simulate = false;
}

/* animate driver marker along path with small random progress */
function animateDriverOnce(forceProgress){
  const len = getPathLength();
  const curMatrix = driverMarker.getAttribute('transform');
  // get current translate x,y
  let match = curMatrix && curMatrix.match(/translate\\(([-0-9\\.]+),\\s*([-0-9\\.]+)\\)/);
  // compute current fraction by approximating by searching the path for the closest point (linear search)
  const steps = 80;
  let bestIdx = 0, bestDist = Infinity;
  for(let i=0;i<=steps;i++){
    const pt = routePath.getPointAtLength(len * (i/steps));
    // current position fallback: if none, start at 0
    const curX = match ? parseFloat(match[1]) : 130;
    const curY = match ? parseFloat(match[2]) : 90;
    const d = Math.hypot(pt.x - curX, pt.y - curY);
    if(d < bestDist){ bestDist = d; bestIdx = i; }
  }
  let curFrac = bestIdx / steps;
  let delta = 0.05 + Math.random()*0.12;
  let target = forceProgress === 1 ? 1 : Math.min(1, curFrac + delta);
  // tween animation
  const duration = 800 + Math.random()*600;
  const start = performance.now();
  function step(ts){
    const t = Math.min(1, (ts - start)/duration);
    const ease = t<0.5 ? 2*t*t : -1 + (4-2*t)*t; // simple ease
    const frac = curFrac + (target - curFrac) * ease;
    setDriverPosition(frac);
    if(t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

/* small helper to auto-select a demo order on page load */
window.addEventListener('load', ()=> {
  // set initial driver marker position
  setDriverPosition(0);
  // optional: pre-load ORD-1024 so UI isn't empty
  renderOrder(JSON.parse(JSON.stringify(MOCK_ORDERS["ORD-1024"])));
  // start a gentle initial driver motion
  animateDriverOnce(0.06);
  // update ETA every minute
  setInterval(()=> updateETADisplay(), 60000);
});
</script>
</body>
</html>
